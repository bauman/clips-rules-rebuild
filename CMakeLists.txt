cmake_minimum_required(VERSION 3.3)
project(clips)
INCLUDE_DIRECTORIES(/usr/include/ core/ )
LINK_DIRECTORIES(/usr/lib64/)

option(static-cli "statically compile CLI" OFF)

set(HEADER_FILES
        core/symbol.h
        core/dffnxbin.h
        core/cstrncmp.h
        core/generate.h
        core/lgcldpnd.h
        core/insmngr.h
        core/msgpass.h
        core/envrnmnt.h
        core/genrccom.h
        core/prntutil.h
        core/factmngr.h
        core/cstrccom.h
        core/globlbin.h
        core/inspsr.h
        core/globldef.h
        core/cstrcpsr.h
        core/evaluatn.h
        core/symblcmp.h
        core/miscfun.h
        core/rulepsr.h
        core/objrtfnx.h
        core/tmpltlhs.h
        core/expressn.h
        core/modulbin.h
        core/reteutil.h
        core/modulutl.h
        core/crstrtgy.h
        core/factrete.h
        core/classpsr.h
        core/dffnxfun.h
        core/insquery.h
        core/dffctbsc.h
        core/constrnt.h
        core/cstrnutl.h
        core/rulebsc.h
        core/multifld.h
        core/cstrnbin.h
        core/memalloc.h
        core/modulbsc.h
        core/conscomp.h
        core/globlcom.h
        core/clips.h
        core/classini.h
        core/factprt.h
        core/default.h
        core/iofun.h
        core/defins.h
        core/msgcom.h
        core/classexm.h
        core/filecom.h
        core/insmoddp.h
        core/pattern.h
        core/proflfun.h
        core/tmpltfun.h
        core/ruledlt.h
        core/rulecstr.h
        core/genrcfun.h
        core/sortfun.h
        core/factmch.h
        core/usrsetup.h
        core/genrcbin.h
        core/dffnxcmp.h
        core/bload.h
        core/rulecmp.h
        core/sysdep.h
        core/tmpltdef.h
        core/factqury.h
        core/genrccmp.h
        core/classinf.h
        core/tmpltbsc.h
        core/objrtbld.h
        core/utility.h
        core/dffctpsr.h
        core/analysis.h
        core/globlcmp.h
        core/constrct.h
        core/filertr.h
        core/dffctcmp.h
        core/extnfunc.h
        core/prcdrpsr.h
        core/argacces.h
        core/tmpltbin.h
        core/insfile.h
        core/tmpltutl.h
        core/symblbin.h
        core/setup.h
        core/exprnbin.h
        core/drive.h
        core/immthpsr.h
        core/bmathfun.h
        core/object.h
        core/agenda.h
        core/bsave.h
        core/inherpsr.h
        core/objcmp.h
        core/factqpsr.h
        core/genrcexe.h
        core/pprint.h
        core/reorder.h
        core/watch.h
        core/tmpltpsr.h
        core/factbld.h
        core/msgfun.h
        core/cstrnchk.h
        core/factcmp.h
        core/rulebld.h
        core/strngfun.h
        core/objrtbin.h
        core/genrcpsr.h
        core/prcdrfun.h
        core/dfinscmp.h
        core/cstrcbin.h
        core/dffnxpsr.h
        core/clsltpsr.h
        core/dffnxexe.h
        core/insmult.h
        core/tmpltrhs.h
        core/ruledef.h
        core/developr.h
        core/factbin.h
        core/rulebin.h
        core/msgpsr.h
        core/incrrset.h
        core/factfun.h
        core/cstrnops.h
        core/userdata.h
        core/dffctbin.h
        core/constant.h
        core/objrtmch.h
        core/rulecom.h
        core/engine.h
        core/retract.h
        core/commline.h
        core/emathfun.h
        core/rulelhs.h
        core/factrhs.h
        core/router.h
        core/insqypsr.h
        core/strngrtr.h
        core/multifun.h
        core/factcom.h
        core/match.h
        core/dfinsbin.h
        core/scanner.h
        core/objbin.h
        core/prdctfun.h
        core/prccode.h
        core/moduldef.h
        core/exprnpsr.h
        core/classfun.h
        core/globlpsr.h
        core/objrtcmp.h
        core/network.h
        core/dffctdef.h
        core/exprnops.h
        core/factlhs.h
        core/cstrccmp.h
        core/globlbsc.h
        core/classcom.h
        core/textpro.h
        core/objrtgen.h
        core/facthsh.h
        core/insfun.h
        core/parsefun.h
        core/tmpltcmp.h
        core/factgen.h
        core/inscom.h
        core/modulcmp.h
        core/cstrnpsr.h
        core/modulpsr.h)
set(SOURCE_FILES
        core/dffnxcmp.c
        core/symbol.h
        core/globlcom.c
        core/dffnxbin.h
        core/cstrncmp.h
        core/facthsh.c
        core/constrnt.c
        core/tmpltcmp.c
        core/generate.h
        core/globlbin.c
        core/generate.c
        core/lgcldpnd.h
        core/insmngr.h
        core/msgpass.h
        core/envrnmnt.h
        core/genrccom.h
        core/immthpsr.c
        core/parsefun.c
        core/prcdrpsr.c
        core/prntutil.h
        core/factmngr.h
        core/cstrccom.h
        core/globlbin.h
        core/inspsr.h
        core/factlhs.c
        core/globldef.h
        core/cstrcpsr.h
        core/tmpltlhs.c
        core/sortfun.c
        core/insquery.c
        core/evaluatn.h
        core/symblcmp.h
        core/miscfun.h
        core/modulpsr.c
        core/rulepsr.h
        core/classpsr.c
        core/objrtfnx.h
        core/tmpltlhs.h
        core/dffnxexe.c
        core/expressn.h
        core/rulebld.c
        core/modulbin.h
        core/filecom.c
        core/reteutil.h
        core/modulutl.h
        core/crstrtgy.h
        core/factrete.h
        core/classpsr.h
        core/dffnxfun.h
        core/classexm.c
        core/lgcldpnd.c
        core/insquery.h
        core/dffctbsc.h
        core/constrnt.h
        core/classfun.c
        core/cstrnutl.h
        core/factprt.c
        core/rulebsc.h
        core/multifld.h
        core/envrnmnt.c
        core/pattern.c
        core/classini.c
        core/cstrnbin.h
        core/factmngr.c
        core/exprnbin.c
        core/bmathfun.c
        core/memalloc.h
        core/textpro.c
        core/modulbsc.h
        core/conscomp.c
        core/conscomp.h
        core/globlcom.h
        core/insmult.c
        core/miscfun.c
        core/dffctcmp.c
        core/objbin.c
        core/clips.h
        core/classini.h
        core/factprt.h
        core/dfinsbin.c
        core/default.h
        core/genrccom.c
        core/proflfun.c
        core/factcom.c
        core/iofun.h
        core/factqpsr.c
        core/defins.h
        core/msgcom.h
        core/rulepsr.c
        core/commline.c
        core/classexm.h
        core/tmpltbin.c
        core/dffctbsc.c
        core/filecom.h
        core/tmpltutl.c
        core/insmoddp.h
        core/incrrset.c
        core/pattern.h
        core/proflfun.h
        core/insmngr.c
        core/tmpltfun.h
        core/ruledlt.h
        core/symblbin.c
        core/rulebsc.c
        core/rulecstr.h
        core/genrcfun.h
        core/rulecom.c
        core/msgfun.c
        core/tmpltdef.c
        core/iofun.c
        core/sortfun.h
        core/factmch.h
        core/insfile.c
        core/usrsetup.h
        core/multifun.c
        core/ruledef.c
        core/genrcbin.h
        core/multifld.c
        core/objrtcmp.c
        core/dffnxcmp.h
        core/dffctbin.c
        core/bload.h
        core/cstrnchk.c
        core/rulecmp.h
        core/sysdep.h
        core/tmpltdef.h
        core/factqury.h
        core/genrccmp.h
        core/exprnops.c
        core/bload.c
        core/factqury.c
        core/inherpsr.c
        core/classinf.h
        core/tmpltbsc.h
        core/prdctfun.c
        core/watch.c
        core/objrtbld.h
        core/utility.h
        core/dffctpsr.h
        core/inspsr.c
        core/analysis.h
        core/rulelhs.c
        core/dffctpsr.c
        core/msgcom.c
        core/factbld.c
        core/factbin.c
        core/genrccmp.c
        core/globlcmp.h
        core/constrct.h
        core/reorder.c
        core/filertr.h
        core/dffctcmp.h
        core/extnfunc.h
        core/prcdrpsr.h
        core/argacces.h
        core/dffnxbin.c
        core/tmpltbin.h
        core/insfile.h
        core/engine.c
        core/tmpltutl.h
        core/symblbin.h
        core/scanner.c
        core/setup.h
        core/analysis.c
        core/userfunctions.c
        core/cstrnbin.c
        core/exprnbin.h
        core/prntutil.c
        core/drive.h
        core/immthpsr.h
        core/bmathfun.h
        core/objcmp.c
        core/object.h
        core/agenda.h
        core/factmch.c
        core/bsave.h
        core/inherpsr.h
        core/objcmp.h
        core/factqpsr.h
        core/genrcexe.h
        core/argacces.c
        core/objrtgen.c
        core/dffctdef.c
        core/globlcmp.c
        core/objrtmch.c
        core/dfinscmp.c
        core/pprint.h
        core/reorder.h
        core/watch.h
        core/tmpltpsr.h
        core/modulbsc.c
        core/factbld.h
        core/agenda.c
        core/tmpltfun.c
        core/emathfun.c
        core/genrcpsr.c
        core/tmpltrhs.c
        core/cstrcpsr.c
        core/objrtfnx.c
        core/insmoddp.c
        core/factfun.c
        core/msgfun.h
        core/cstrnchk.h
        core/cstrncmp.c
        core/factcmp.h
        core/rulebld.h
        core/inscom.c
        core/memalloc.c
        core/factrhs.c
        core/strngfun.h
        core/objrtbin.h
        core/default.c
        core/genrcpsr.h
        core/insqypsr.c
        core/prcdrfun.h
        core/dfinscmp.h
        core/makefile.win
        core/cstrcbin.h
        core/dffnxpsr.h
        core/evaluatn.c
        core/dffnxfun.c
        core/objrtbin.c
        core/expressn.c
        core/clsltpsr.h
        core/dffnxexe.h
        core/modulcmp.c
        core/insmult.h
        core/insfun.c
        core/tmpltrhs.h
        core/ruledef.h
        core/modulutl.c
        core/cstrnutl.c
        core/factcmp.c
        core/developr.h
        core/factbin.h
        core/cstrccom.c
        core/strngfun.c
        core/drive.c
        core/globldef.c
        core/rulebin.h
        core/msgpsr.h
        core/objrtbld.c
        core/incrrset.h
        core/tmpltbsc.c
        core/ruledlt.c
        core/factfun.h
        core/cstrnops.h
        core/factgen.c
        core/userdata.c
        core/userdata.h
        core/dffctbin.h
        core/msgpass.c
        core/globlbsc.c
        core/genrcexe.c
        core/genrcbin.c
        core/classinf.c
        core/filertr.c
        core/crstrtgy.c
        core/constant.h
        core/cstrnpsr.c
        core/objrtmch.h
        core/rulecom.h
        core/engine.h
        core/exprnpsr.c
        core/defins.c
        core/prccode.c
        core/tmpltpsr.c
        core/retract.h
        core/commline.h
        core/emathfun.h
        core/rulelhs.h
        core/factrhs.h
        core/router.h
        core/insqypsr.h
        core/strngrtr.h
        core/multifun.h
        core/extnfunc.c
        core/prcdrfun.c
        core/factcom.h
        core/match.h
        core/globlpsr.c
        core/dfinsbin.h
        core/scanner.h
        core/makefile
        core/pprint.c
        core/retract.c
        core/rulecmp.c
        core/rulebin.c
        core/objbin.h
        core/dffnxpsr.c
        core/moduldef.c
        core/modulbin.c
        core/prdctfun.h
        core/router.c
        core/prccode.h
        core/moduldef.h
        core/msgpsr.c
        core/constrct.c
        core/exprnpsr.h
        core/classfun.h
        core/globlpsr.h
        core/symblcmp.c
        core/objrtcmp.h
        core/reteutil.c
        core/network.h
        core/dffctdef.h
        core/exprnops.h
        core/rulecstr.c
        core/strngrtr.c
        core/bsave.c
        core/factlhs.h
        core/cstrccmp.h
        core/factrete.c
        core/cstrcbin.c
        core/globlbsc.h
        core/classcom.h
        core/sysdep.c
        core/genrcfun.c
        core/textpro.h
        core/objrtgen.h
        core/facthsh.h
        core/symbol.c
        core/insfun.h
        core/parsefun.h
        core/tmpltcmp.h
        core/factgen.h
        core/developr.c
        core/inscom.h
        core/clsltpsr.c
        core/classcom.c
        core/cstrnops.c
        core/modulcmp.h
        core/utility.c
        core/cstrnpsr.h
        core/modulpsr.h)



if(WIN32)
    add_library(clips SHARED core/main.c ${SOURCE_FILES})
    add_library(clips-static core/main.c ${SOURCE_FILES})
    add_definitions(-DWIN_MVC=1)
    add_definitions(-D_CRT_SECURE_NO_WARNINGS)
    add_executable(clipscli core/main.c)
    target_link_libraries(clipscli clips )
    install(TARGETS clipscli clips clips-static
            RUNTIME DESTINATION bin
            LIBRARY DESTINATION lib
            ARCHIVE DESTINATION lib/static)

else()
    add_library(clips SHARED ${SOURCE_FILES})
    add_library(clips-static ${SOURCE_FILES})
    set_target_properties(clips PROPERTIES LINK_FLAGS_RELEASE -s)
    set_target_properties(clips-static PROPERTIES LINK_FLAGS_RELEASE -s)
    target_link_libraries(clips m)
    target_link_libraries(clips-static m)
    add_executable(clipscli core/main.c)
    if(static-cli)
        set(CMAKE_FIND_LIBRARY_SUFFIXES ".a")
        set(BUILD_SHARED_LIBS OFF)
        set(CMAKE_EXE_LINKER_FLAGS "-static -s")
        target_link_libraries(clipscli clips-static )
    else()
        set(CMAKE_EXE_LINKER_FLAGS "-s")
        target_link_libraries(clipscli clips )
    endif()
    install(FILES ${HEADER_FILES} DESTINATION include)
    install(TARGETS clipscli clips clips-static
            RUNTIME DESTINATION bin
            LIBRARY DESTINATION lib
            ARCHIVE DESTINATION lib/static)
endif()









enable_testing()


